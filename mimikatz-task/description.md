<b>Автор таска</b>: Аверин Илья Олегович <br>
<b>Темы</b>: Атака на SSH, Извлечение паролей из lsass.exe <br>
<b>Инструменты для решения задач</b>: sshprank, Mimikatz, hashcat <br>
Топология: <br>
![tolopogy](./img/tolopogy7.png)
<b>Описание стенда</b>: <br>
Стенд представляет под собой доменную инфраструктуру под управлением Active Directory.<br>
Все устройства, кроме хакера находятся под управлением контроллера домена (DC1).<br>
DC1 – WinServer16 <br>
PC1 – Win 10 Pro (с открытым ssh портом на 22 порту с аутентификацией по паролю, без межсетевого экрана).<br>
Hacker – Kali Linux<br>
Router – Cisco (DNS не настроен)<br>
Дать пользователю файл с пользователями(users.txt) и паролями(passwords.txt), где хранятся креды от учётки для ssh-аутентификации.<br>
<b>Условие пользователю</b>: <br> Сеть 192.168.0.0/16. На домене контроллера открыт ssh-порт с аутентификацией по паролю и неограниченными попытками аутентификации. Необходимо предоставить в ответе и пароль от учётной записи Admin. На пользовательской машине отключён Windows Defender.<br>
<b>Справка пользователю</b>:<br>
SSHprank - это инструмент для тестирования на проникновение в систему с использованием протокола SSH. Он может выполнять различные атаки и тестировать уязвимости в SSH-серверах. Это инструмент, который может использоваться разработчиками и администраторами для обнаружения и устранения уязвимостей в SSH-серверах. Однако обратите внимание, что использование этого инструмента для атаки на несанкционированные системы может быть незаконным.<br>
Mimikatz — это приложение с открытым исходным кодом, которое позволяет пользователям просматривать и сохранять учетные данные аутентификации, такие как тикеты Kerberos. Бенджамин Делпи продолжает руководить разработкой Mimikatz, поэтому набор инструментов работает с текущей версией Windows и включает самые современные виды атак. <br>
Установка sshprank:<br>
sudo apt install python3-pip<br>
cd /tmp/<br>
git clone https://github.com/noptrix/sshprank <br>
cd sshprank<br>
sudo pip3 install -r docs/requirements.txt<br>
./sshprank.py –H (в случае ошибки – через виртуальное окружение).<br>
<b>Информация для Blue team</b>:<br>
Самый верный способ защиты от взлома аутентификационных данных SHH – это использовать также аутентификацию по ключам, OTP-аутентификацию. Также использовать ограничение на количество раз неверной аутентификации за определённый промежуток времени (fail2ban в Linux). Также помогает определение ip-адресов и mac-адресов, с которых может происходить ssh-аутентификация к хосту (iptables).
